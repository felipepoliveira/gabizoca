<!DOCTYPE html>
<html lang="pt">
    <head>
        <title></title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="style.css">
    </head>
    <body class="black">
        <div id="main" class="flex-container view view-show">
            <div id="login-box" class="container">
                <h2>It's<br/> <span class="clear-text">for you</span><br/>Gabizoca</h2>
                <div class="container center">
                    <input type="text" id='inputDia' placeholder="Dia" maxlength="2">
                    <input type="text" id='inputMes' placeholder="Mês" maxlength="2">                
                    <input type="text" id='inputAno' placeholder="Ano"  maxlength="4">
                </div>
                <div class="container center ma-lg">
                    <button id="btnheart">♥</button>
                </div>
            </div>
        </div>
        <div id="anniversary-box" class="view">
            <img src="images/flower.png"/>
            <h2>TE AMO</h2>
        </div>
        <div id="greenday-box" class="view">
            <h2>Green Day</h2>
            <img src="images/gd.jpg">
            <div class="images-container" id="greenDayImages">
            </div>
        </div>
        <div id="ibirapuera-2017-box" class="view">
            <img src="images/ibira-2017.jpg" class="center" style="max-width: 800px;">
        </div>
        <div id="overlay" class="overlay"></div>
        <audio src="audios/ibira-2017.mp3" id="audioIbira2017" loop="loop">
    </body>
    <script>
        var $inputDia = document.querySelector("#inputDia");
        var $inputMes = document.querySelector("#inputMes");
        var $inputAno = document.querySelector("#inputAno");
        var $main = document.querySelector("#main");
        var $anniversaryBox = document.querySelector("#anniversary-box");
        var $greenDayBox = document.querySelector("#greenday-box");
        var $ibira2017Box = document.querySelector("#ibirapuera-2017-box");
        var $loginBox = document.querySelector("#login-box");

        //Audios
        var audioIbira2017 = document.querySelector("#audioIbira2017");

        document.querySelector("#btnheart").addEventListener('click', () => {
           

            if(openDatingAnniversary()){

            }else if(openGreenDay()){

            }else if(openIbira2017()){
                audioIbira2017.play();
                toggleOverlay({
                    "background-image" : "url('images/snow.gif')",
                    "opacity" : "0.5"
                });
            }
        });

        function applyPhotos(where, prefix, ext, howMutch){
            //Remove each child
            Array(where.querySelectorAll("img")).forEach((c) => {
                console.log(c);
            });

            //Apply all images
            for(let i = 1; i <= howMutch; i++){
                let image = new Image();
                image.onload = () => {
                    setTimeout(() => {
                        where.appendChild(image);
                    }, 500);
                }
                image.src = "images/" + prefix + "-" + i + "." + ext;
            }

        }

        function openDatingAnniversary(){
            if($inputDia.value === "12" && $inputMes.value === "11" && $inputAno.value === "2017"){
                    document.body.classList.toggle("black");
                    toggleView($anniversaryBox);

                    return true;
            }else{
                return false;
            }
        }

        function openGreenDay(){
            if(parseInt($inputDia.value) === 3 && $inputMes.value === "11" && $inputAno.value === "2017"){
                toggleView($greenDayBox);
                applyPhotos(document.querySelector("#greenDayImages"), "gd", "jpg", 9);
                return true;
            }else{
                return false;
            }
        }

        function openIbira2017(){
            if($inputDia.value === "25" && $inputMes.value === "11" && $inputAno.value === "2017"){
                toggleView($ibira2017Box);
                return true;
            }else{
                return false;
            }
        }

        function toggleOverlay(obj){
            
            let o = document.querySelector("#overlay")
            o.classList.toggle("show");

            console.log(Object.keys(obj));
            Object.keys(obj).forEach(prop => {
                o.style[prop] = obj[prop];
            });
        }

        function toggleView(box){
            $main.classList.toggle("view-show");
            box.classList.toggle("view-show");
        }
    </script>
</html>
